<!DOCTYPE html>
<html>
<head>
   <meta http-equiv="content-type" content="text/html;charset=utf-8"> 
   <title>Certificate Authorities & SSL</title>

<meta name="generator" content="Slide Show (S9) 1.2.3 on Ruby 2.0.0 (2013-06-27) [x86_64-linux]">
<meta name="author"    content="Matt Glover" >

<!-- helper/macro that lets you add (CSS3) gradient using headers
     see http://slideshow.rubyforge.org/themes.html
     
       /****
       * generated by gradient_from_headers helper; using headers: 
       *   gradient-theme: radial-off-center
       *   gradient-colors: #ff5c5c #cecece
       */
    .slide    { background-image: -webkit-radial-gradient( 70% 70%, ellipse, #ff5c5c, #cecece );
                background-image: -moz-radial-gradient( 70% 70%, ellipse, #ff5c5c, #cecece );
                background-image: -ms-radial-gradient( 70% 70%, ellipse, #ff5c5c, #cecece );
                background-image: -o-radial-gradient( 70% 70%, ellipse, #ff5c5c, #cecece );
                background-image: radial-gradient( 70% 70%, ellipse, #ff5c5c, #cecece );
              }
   -->

<!-- S6 style sheet links -->
<link rel="stylesheet" href="presentation.css" media="projection" id="styleProjection">
<link rel="stylesheet" href="s6/screen.css"         media="screen"     id="styleScreen">
<link rel="stylesheet" href="s6/print.css"          media="print">

<!-- S6 JS -->
<script src="s6/jquery.js"></script>
<script src="s6/jquery.slideshow.js"></script>
<script>
  $(document).ready( function() {
    Slideshow.init();
  } );

  
</script>

<!-- Better Browser Banner for Microsoft Internet Explorer (IE) -->
<!--[if IE]>
<script src="s6/jquery.microsoft.js"></script>
<![endif]-->



</head>
<body>

<div class="layout"> 
  <div id="header"></div>
  <div id="footer">
    <h1></h1>
    <h2></h2>
  </div>
</div>

<div class="presentation">
   
<div class='slide '>
<!-- === begin markdown block =====================================================

      generated by markdown 1.0.0 on Ruby 2.0.0 (2013-06-27) [x86_64-linux]
                on 2014-02-26 22:59:12 -0500 with Markdown engine kramdown (0.14.2)
                  using options { !to be done! }
  -->

<!-- _S9SLIDE_ -->
<h1 id="certificate-authorities--ssl">Certificate Authorities &amp; SSL</h1>
<hr />

<h3 id="centerthe-goodcenter"><center>The Good,</center></h3>

<h3 id="centerthe-bad-andcenter"><center>The Bad and</center></h3>

<h3 id="centerthe-break-inscenter"><center>The Break-ins</center></h3>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="what-will-be-covered">What Will Be Covered</h1>
<ul>
  <li>Acronym Soup</li>
  <li>Certificate Authorities (CAs) and TLS/SSL</li>
  <li>CAs and SSL in the News</li>
  <li>Known Weak Points</li>
  <li>Suggested Solutions</li>
</ul>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="acronym-and-definition-soup">Acronym and Definition Soup</h1>

<ul>
  <li>TLS - Transport Layer Security</li>
  <li>SSL - Secure Sockets Layer</li>
  <li>PKI - Public Key Infrastructure</li>
  <li>CA - Certificate Authority</li>
  <li>D-H - Diffie-Hellman key exchange</li>
  <li>MitM - Man-in-the-middle attack</li>
  <li>WoT - Web of Trust</li>
</ul>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="tlsssl">TLS/SSL</h1>

<!-- begin left {} -->
<table width="100%"><tr><td width="50%" style="vertical-align: top;">

      <h3 id="what-it-is">What It Is</h3>
      <ul>
        <li>A cryptographic protocol</li>
        <li>Protection for data in transit</li>
        <li>A key exchange protocol</li>
        <li>Eavesdropping and message tampering prevention</li>
      </ul>

    </td>
<!-- end left -->






<!-- begin right {} -->
<td width="50%" style="vertical-align: top;">

      <h3 id="what-it-is-not">What It Is <strong>NOT</strong></h3>
      <ul>
        <li>An encryption algorithm</li>
        <li>Protection for data at rest</li>
        <li>Strictly dependent on certificate authorities</li>
        <li>The same as SSH</li>
      </ul>

    </td></tr></table>
<!-- end right -->


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="where-is-tls-used">Where is TLS Used?</h1>
<ul>
  <li>HTTP - HTTPS</li>
  <li>FTP - FTPS (explicit) over standard FTP via “AUTH TLS”
    <ul>
      <li>This is <em>not</em> the same as SFTP</li>
    </ul>
  </li>
  <li>SMTP - Using STARTTLS</li>
  <li>NNTP - NNTPS to provide Network News Transfer Protocol over TLS</li>
  <li>XMPP - Used to encrypt the communication channel. SASL is used for authentication</li>
  <li>VPN - OpenVPN uses TLS for key exchange</li>
  <li>SIP - Encrypted on port 5061</li>
</ul>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="pki-cas-x509-and-certificates">PKI, CAs, X.509, and Certificates</h1>
<ul>
  <li>Public Key Infrastructure (PKI) is a means for managing/distributing digital certificates</li>
  <li>Typically CA digitally signs and publishes a public key for a user using its own private key</li>
  <li>CA is a trusted third party so: CA trust =&gt; User key trust</li>
  <li>X.509 is a standard for PKI that specifies the standard format for certificates, revocation, and the certificate validation algorithm</li>
  <li>Intermediate versus Trusted Root Certificates</li>
</ul>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="cas-continued">CAs Continued</h1>
<ul>
  <li>Registration Authority (RA) provides multiple levels of
assurance that the user is who they claim
    <ul>
      <li>Domain Validation - Send an email root@example.com</li>
      <li>Extended Validation:
        <ul>
          <li>Verify legal identity and physical presence of owner</li>
          <li>Exclusive domain control</li>
          <li>Verify legal authority of requester</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Wildcard Certificate</li>
  <li>CA web browser integration
    <ul>
      <li>Lets look at some certs!</li>
    </ul>
  </li>
  <li>CRL and Online Certificate Status Protocol</li>
</ul>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="fscking-tls-how-does-it-work">Fscking TLS, how does it work?</h1>
<p><img src="images/tls_handshake1.png" style="display: block;margin-left: auto;margin-right: auto;height: 80%;" title="TLS Handshake Negotiation" alt="TLS Handshake Negotiation" /></p>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="tls-clienthello">TLS (ClientHello)</h1>
<p><img src="images/tls_breakout_1.png" style="display: block;margin-left: auto;margin-right: auto;height: 80%;" title="TLS Handshake Negotiation ClientHello" alt="TLS Handshake Negotiation ClientHello" /></p>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="tls-serverhello">TLS (ServerHello)</h1>
<p><img src="images/tls_breakout_2.png" style="display: block;margin-left: auto;margin-right: auto;height: 80%;" title="TLS Handshake Negotiation ServerHello" alt="TLS Handshake Negotiation ServerHello" /></p>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="tls-certificate">TLS (Certificate)</h1>
<p><img src="images/tls_breakout_3.png" style="display: block;margin-left: auto;margin-right: auto;width: 100%;" title="TLS Handshake Negotiation Certificate" alt="TLS Handshake Negotiation Certificate" /></p>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="tls-negotiation-wrap-up">TLS (Negotiation Wrap-up)</h1>
<p><img src="images/tls_handshake1.png" style="display: block;margin-left: auto;margin-right: auto;height: 80%;" title="TLS Handshake Negotiation" alt="TLS Handshake Negotiation" /></p>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="tls-post-negotiation">TLS (Post Negotiation)</h1>
<p><img src="images/tls_handshake2.png" style="display: block;margin-left: auto;margin-right: auto;height: 80%;" title="TLS Handshake Post Negotiation" alt="TLS Handshake Post Negotiation" /></p>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="tls-client-begins-encryption">TLS (Client Begins Encryption)</h1>
<p><img src="images/tls_breakout_4.png" style="display: block;margin-left: auto;margin-right: auto;width: 100%;" title="TLS Client Encryption and HMAC Verification" alt="TLS Client Encryption and HMAC Verification" /></p>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="tls-server-begins-encryption">TLS (Server Begins Encryption)</h1>
<p><img src="images/tls_breakout_5.png" style="display: block;margin-left: auto;margin-right: auto;width: 100%;" title="TLS Server Encryption and HMAC Verification" alt="TLS Server Encryption and HMAC Verification" /></p>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="tls-handshake-in-review">TLS Handshake in Review</h1>
<p><img src="images/handshake_review.png" style="display: block;margin-left: auto;margin-right: auto;width: 70%;" title="Yo dawg I heard you like encryption" alt="Yo dawg I heard you like encryption" /></p>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="demo">Demo</h1>
<p>TLS via Wireshark</p>

<p>(ip.addr == 127.0.0.1) &amp;&amp; (ssl)</p>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="public-key-cryptography">Public-Key Cryptography</h1>

<p>Public-key cryptography is essentially the use of asymmetric
algorithms which produce a public and private key pair.</p>

<p>RSA for example: User creates and publishes the product of
two large primes (p, q) and an auxiliary value (e), as their public
key. The prime factors must be kept secret. The RSA algorithm
is such that anyone can use the public key result to encrypt a
message but the prime factors are required to decrypt the
message.</p>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="rsa---show-some-of-your-work">RSA - Show (some of) Your Work!</h1>
<ul>
  <li>Two large primes (<code>p</code> and <code>q</code>) are generated and stored privately</li>
  <li>The product of the primes, <code>n</code>, is the modulus for the public and private keys</li>
  <li>Privately calculate: <code>φ(n) = (p – 1)(q – 1)</code>, where <code>φ</code> is <a href="http://en.wikipedia.org/wiki/Euler%27s_totient_function">Euler’s totient function</a>.</li>
  <li>Determine <code>e</code> where: <code>1 &lt; e &lt; φ(n)</code> and <code>gcd(e,φ(n)) = 1</code></li>
  <li>Publish <code>e</code> as the public key exponent</li>
  <li>Determine <code>d</code> where: <code>d = e–1 mod φ(n)</code></li>
  <li>Encrypt data with the public key using: <code>c = m·e (mod n)</code>
    <ul>
      <li><code>m</code> is the padded message as an integer</li>
      <li><code>c</code> is the encrypted text</li>
    </ul>
  </li>
  <li>Decrypt the data with the private key using: <code>m = c·d (mod n)</code></li>
</ul>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="d-h-key-exchange">D-H Key Exchange</h1>
<p><img src="images/d-h1.png" style="display: block;margin-left: auto;margin-right: auto;height: 70%;" title="Diffie-Hellman Key Exchange 1 of 2" alt="Diffie-Hellman Key Exchange" /></p>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="d-h-key-exchange-part-ii">D-H Key Exchange (Part II)</h1>
<p><img src="images/d-h2.png" style="display: block;margin-left: auto;margin-right: auto;height: 70%;" title="Diffie-Hellman Key Exchange 2 of 2" alt="Diffie-Hellman Key Details" /></p>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="wrong-certificate-example">Wrong Certificate Example</h1>
<p>Dave wants to log on to his favorite Twilight™ fan site:
<a href="http://www.fairiesvampires.com/main/authorization/signIn">http://www.fairiesvampires.com/main/authorization/signIn</a></p>

<p>But he does not want his credentials to be transmitted in the
clear otherwise someone might log in as him and claim he does
not love sensitive caring vampires!</p>

<p>So he changes the URL to https!
<a href="https://www.fairiesvampires.com/main/authorization/signIn">https://www.fairiesvampires.com/main/authorization/signIn</a></p>

<p>But things do not go as expected. What should Dave do!?</p>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="brief-detour---https-best-practices">Brief Detour - HTTPS Best Practices</h1>
<p>Stolen from OWASP: <a href="http://goo.gl/GjkGI">http://goo.gl/GjkGI</a></p>

<ul>
  <li>Use TLS for all login and authenticated pages</li>
  <li>Use TLS to transmit sensitive data</li>
  <li>Do not provide non-TLS pages for secure content
    <ul>
      <li>HTTP =&gt; HTTPS redirects and HSTS</li>
    </ul>
  </li>
  <li>Do not mix TLS and non-TLS content</li>
  <li>Use the “Secure” cookie flag</li>
  <li>Keep sensitive data out of the URL</li>
  <li>Prevent caching of sensitive data</li>
</ul>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="more-examples">More Examples</h1>
<ul>
  <li>Mixed content example site: <a href="https://ie.microsoft.com/testdrive/browser/mixedcontent/assets/woodgrove.htm">https://ie.microsoft.com/testdrive/browser/mixedcontent/assets/woodgrove.htm</a></li>
  <li>Rails &gt;= 3.1
    <ul>
      <li>Set <code>config.force_ssl=true</code> in your environment configuration
        <ul>
          <li>Forces all connections to use HTTPS</li>
        </ul>
      </li>
      <li>Any cookies marked “Secure” will be transmitted over HTTPS only</li>
      <li>Autoredirect to HTTPS, “Secure” cookies, and HSTS</li>
    </ul>
  </li>
  <li>Optionally set up HSTS
    <ul>
      <li>Only set this for HTTPS connections</li>
      <li>Nginx example:</li>
    </ul>
  </li>
</ul>

<!-- begin code{} -->
<div class="code"><pre class="brush: ruby toolbar: false gutter: true">
add_header Strict-Transport-Security max-age=31536000;
</pre></div>
<!-- end code -->


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="bad-press-for-cas-and-tls-2011-2013">Bad Press for CAs and TLS 2011-2013</h1>
<p>CA Issues:</p>

<ul>
  <li><a href="http://blogs.comodo.com/it-security/data-security/the-recent-ra-compromise/">Comodo affiliate</a> issues fraudulent certs for domains like <code>mail.google.com</code>, <code>login.yahoo.com</code>, <code>addons.mozilla.org</code></li>
  <li><a href="http://googleonlinesecurity.blogspot.com/2011/08/update-on-attempted-man-in-middle.html">CA DigiNotar</a> compromised subjecting users to MitM via fraudulent certs</li>
  <li><a href="https://blogs.adobe.com/asset/2012/09/inappropriate-use-of-adobe-code-signing-certificate.html">Adobe code signing certificates</a> stolen and used to sign malicious software</li>
  <li><a href="https://blog.bit9.com/2013/02/08/bit9-and-our-customers-security/">Bit9 code signing certificates</a> were stolen allowing malware to be signed as legitimate software</li>
</ul>

<p>TLS and Other Issues:</p>

<ul>
  <li>Chrome 14/15 allowed certain types of redirects to display a valid HTTPS URL with content from a different site</li>
  <li><a href="https://threatpost.com/en_us/blogs/new-attack-breaks-confidentiality-model-ssl-allows-theft-encrypted-cookies-091911">B.E.A.S.T.</a> decrypts part of PayPal encrypted data stream using a chosen plain-text attack against TLS 1.0 because it uses a predictable IV in CBC mode</li>
  <li><a href="https://threatpost.com/en_us/blogs/crime-attack-uses-compression-ratio-tls-requests-side-channel-hijack-secure-sessions-091312">CRIME</a> uses an information leak in the compression ratio of TLS requests as a side channel to enable decryption of requests from client to server</li>
  <li><a href="http://www.isg.rhul.ac.uk/tls/">Lucky Thirteen TLS and DTLS MitM</a> discovered via an advanced padding oracle attack against HMAC-SHA1 MACs</li>
</ul>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="weaknesses-real-and-perceived">Weaknesses (Real and Perceived)</h1>
<ul>
  <li>Domain Validation versus Extended Validation</li>
  <li>CA is a central point of failure</li>
  <li>Certificates scoped by convention not protocol
    <ul>
      <li>Any CA can issue a certificate for any site</li>
    </ul>
  </li>
  <li>TLS 1.0 amplified difficulties in patching a widespread protocol</li>
  <li>Browser handling is confusing at best and can be abused with tools like sslstrip</li>
</ul>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="proposed-solutions-and-mitigations">Proposed Solutions and Mitigations</h1>
<ul>
  <li>SSL Observatory: <a href="https://www.eff.org/observatory">https://www.eff.org/observatory</a></li>
  <li>Use DNSSEC or HTTPS headers for authenticity check</li>
  <li>Updating CA operational guidelines and standards</li>
  <li>Sovereign Keys: <a href="https://www.eff.org/sovereign-keys">https://www.eff.org/sovereign-keys</a></li>
  <li>Google researchers suggest public append log, proofs, and client check: <a href="http://goo.gl/8yKLR">http://goo.gl/8yKLR</a></li>
  <li>Convergence: <a href="http://convergence.io/">http://convergence.io/</a></li>
  <li>Monkeysphere: <a href="http://web.monkeysphere.info/">http://web.monkeysphere.info/</a></li>
</ul>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="questions">Questions?</h1>
<p>Name: Matt Glover</p>

<p>Email: matt.glover@mandiant.com</p>

<p>Type: Public PGP Key</p>

<p>Key ID: 54C013B4</p>

<!-- === end markdown block ===================================================== -->
</div>


</div><!-- presentation -->
</body>
</html>